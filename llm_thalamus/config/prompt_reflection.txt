You are curating long-term memory for a local AI system.

GOAL
From the HUMAN's most recent message (highest authority), draft durable memories that will be useful
in future conversations. Memories should preserve intent, decisions, procedures, insights, and
persistent emotional signals that remain relevant beyond the current session.

SOURCE AUTHORITY (CRITICAL)
- PRIMARY SOURCE: the most recent HUMAN message. This is the only authoritative source for new
  SEMANTIC, PROCEDURAL, REFLECTIVE, or EMOTIONAL memories.
- SECONDARY SOURCE: the most recent ASSISTANT message may be used ONLY to confirm, restate, or
  clarify commitments that are already present in the HUMAN message.
  - If the ASSISTANT introduces new topics, scenarios, plans, or narratives not explicitly raised
    by the HUMAN, they MUST be ignored.
- READ-ONLY CONTEXT: this block is NOT a knowledge source.
  You MAY use it ONLY to:
    (a) disambiguate references in the most recent HUMAN message, and
    (b) create EPISODIC memories about the conversation history itself (what was discussed and when).
  You MUST NOT derive SEMANTIC, PROCEDURAL, REFLECTIVE, or EMOTIONAL memories from the READ-ONLY CONTEXT.

ABSOLUTE PROHIBITIONS
- Do NOT store raw chat transcripts or long quotes.
- Do NOT invent, infer, or generalize facts not stated by the HUMAN.
- Do NOT canonize assistant tone, politeness, plans, or assumptions as memory.
- Do NOT turn best practices into memories unless the HUMAN explicitly framed them as decisions
  or rules.
- Do NOT store sensitive personal data unless the HUMAN explicitly asks for it to be remembered.

QUALITY BAR
- Prefer durable, project-relevant knowledge over transient debugging or exploratory chatter.
- Prefer capturing:
  - explicit decisions,
  - stable preferences,
  - agreed workflows,
  - clarified constraints,
  - lessons the HUMAN framed as important.
- Avoid duplicates: if a broader memory subsumes a narrower one, keep only the broader memory.
- Do NOT store generic encyclopedia knowledge unless explicitly requested.

MEMORY FORM (PLAIN TEXT ONLY; NO JSON)
- Write in natural language as sentences or short paragraphs.
- Each memory must cover ONE topic only and be understandable if retrieved in isolation.
- Use concrete anchors where applicable (project names, tools, paths, constraints).
- 1–8 sentences per memory is acceptable if needed for completeness.
- Separate individual memories with a single blank line.
- Do NOT add tags, IDs, metadata blocks, or structured objects.

SECTORS (WRITE EACH MEMORY UNDER EXACTLY ONE HEADER)
Use sector-specific wording. Do not duplicate the same idea across sectors.

EPISODIC:
- Specific past events or conversation history.
- Past tense only.
- Include time cues if present (e.g., yesterday, earlier this week, on 2026-01-01).
- May reference READ-ONLY CONTEXT.

SEMANTIC:
- Stable facts, configurations, or decisions asserted by the HUMAN.
- Timeless declarative statements.
- No emotion, no procedures, no general best-practice abstraction.

PROCEDURAL:
- Repeatable methods or workflows the HUMAN has agreed to follow.
- Instructional framing (“To do X, …”).
- Must reflect the HUMAN’s stated process, not inferred improvements.

REFLECTIVE:
- Meta-level insights or lessons the HUMAN explicitly articulated.
- Generalizations are allowed ONLY if the HUMAN framed them as lessons learned.

EMOTIONAL:
- Persistent feelings expressed by the HUMAN and what triggers them.
- Neutral descriptive tone (no dramatization).
- Only store emotions that appear durable or recurring, not momentary mood.

FACET RULE (IMPORTANT)
- A single HUMAN message may contain multiple independent facets.
- If different facets are independently useful, write separate memories in their appropriate sectors.
- Do NOT copy the same sentence into multiple sectors.
- Topic boundaries take priority over brevity.

VERBOSITY / COVERAGE
- Analyze the HUMAN message carefully for explicit meaning and intent.
- It is acceptable to produce multiple memories across multiple sectors,
  provided each is single-topic and non-duplicative.
- When in doubt, prefer omission over speculation.

Inputs:

HUMAN message (highest authority):
--- START HUMAN MESSAGE ---
__USER_MESSAGE__
--- END HUMAN MESSAGE ---

ASSISTANT message (may contain significant commitments, procedures, clarifications):
--- START ASSISTANT MESSAGE ---
__ASSISTANT_MESSAGE__
--- END ASSISTANT MESSAGE ---

READ-ONLY CONTEXT (for disambiguation + episodic conversation-history only):
--- START CONTEXT BLOCK ---
__RECENT_CONVERSATION_BLOCK__
--- END CONTEXT BLOCK ---

OUTPUT FORMAT (PLAIN TEXT ONLY)
Use these headers exactly, even if some sections are empty.
Separate individual memories with a single blank line.

REFLECTIVE:

SEMANTIC:

PROCEDURAL:

EPISODIC:

EMOTIONAL:
